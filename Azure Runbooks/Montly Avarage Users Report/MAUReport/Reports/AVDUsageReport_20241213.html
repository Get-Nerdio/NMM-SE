<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AVDUsageReport_20241213</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .logo {
            height: 50px;
        }
        .title {
            font-size: 24px;
            color: #333;
        }
        .info {
            font-size: 14px;
            color: #666;
        }
        .metrics-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .metric-card {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            text-align: center;
        }
        .metric-title {
            font-size: 14px;
            color: #666;
            margin-bottom: 10px;
        }
        .metric-value {
            font-size: 24px;
            color: #333;
            font-weight: bold;
        }
        .section {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .section-title {
            font-size: 18px;
            color: #333;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .chart-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        .chart-wrapper {
            position: relative;
            height: 300px;
            margin-bottom: 20px;
        }
        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        .analytics-card {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
        }
        .analytics-title {
            font-size: 16px;
            color: #333;
            margin-bottom: 10px;
        }
        .analytics-list {
            font-size: 14px;
        }
        .analytics-list-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            padding: 5px 0;
            border-bottom: 1px solid #eee;
        }
        .analytics-label {
            color: #666;
        }
        .analytics-value {
            font-weight: bold;
            color: #333;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            font-size: 14px;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #f8f9fa;
            font-weight: bold;
            color: #333;
        }
        tr:hover {
            background-color: #f5f5f5;
        }
        .time-range-selector {
            padding: 5px 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            color: #333;
        }
        .session-duration {
            white-space: nowrap;
        }
        @media (max-width: 768px) {
            .metrics-container {
                grid-template-columns: 1fr 1fr;
            }
            .chart-container {
                grid-template-columns: 1fr;
            }
            .analytics-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <img src="/Users/skolte/Documents/GitHub/NMM-SE/Azure Runbooks/Montly Avarage Users Report/MAUReport/Private/../Static/NerrdioMSPLogo.png" alt="Logo" class="logo">
        <div>
            <div class="title">AVDUsageReport_20241213</div>
            <div class="info">Time Range: 2024-11-13 to 2024-12-13</div>
            <div class="info">Host Pool: nerdio desktop win10</div>
        </div>
    </div>

    <div class="metrics-container">
                <div class="metric-card">
            <div class="metric-title">Average Monthly Users</div>
            <div class="metric-value">75</div>
        </div>
        <div class="metric-card">
            <div class="metric-title">Average Weekly Users</div>
            <div class="metric-value">62.4</div>
        </div>
        <div class="metric-card">
            <div class="metric-title">Average Daily Users</div>
            <div class="metric-value">33.9</div>
        </div>
        <div class="metric-card">
            <div class="metric-title">Peak Daily Users</div>
            <div class="metric-value">54</div>
        </div>
    </div>

    <div class="section">
        <div class="section-title">
            <span>Distribution Analytics</span>
            <select id="timeRange" class="time-range-selector">
                <option value="monthly">Monthly</option>
                <option value="weekly">Weekly</option>
                <option value="daily">Daily</option>
            </select>
        </div>
        
        <div class="analytics-grid">
            <div class="analytics-card">
                <div class="analytics-title">Transport Types Distribution</div>
                <div id='transportTypesSummary' class='analytics-list'><div class='analytics-list-item'>
                <span class='analytics-label'>TURN</span>
                <span class='analytics-value'>33.3%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>Websocket</span>
                <span class='analytics-value'>33.3%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>Shortpath</span>
                <span class='analytics-value'>33.3%</span>
            </div></div>
            </div>
            <div class="analytics-card">
                <div class="analytics-title">Gateway Regions Distribution</div>
                <div id='gatewayRegionsSummary' class='analytics-list'><div class='analytics-list-item'>
                <span class='analytics-label'>eastus2</span>
                <span class='analytics-value'>4.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'><></span>
                <span class='analytics-value'>4.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>southeastasia</span>
                <span class='analytics-value'>4.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>southindia</span>
                <span class='analytics-value'>4.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>centralindia</span>
                <span class='analytics-value'>4.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>australiasoutheast</span>
                <span class='analytics-value'>4.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>australiaeast</span>
                <span class='analytics-value'>4.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>southafricanorth</span>
                <span class='analytics-value'>4.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>switzerlandnorth</span>
                <span class='analytics-value'>4.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>israelcentral</span>
                <span class='analytics-value'>4.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>westus</span>
                <span class='analytics-value'>4.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>westus3</span>
                <span class='analytics-value'>4.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>brazilsouth</span>
                <span class='analytics-value'>4.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>southcentralus</span>
                <span class='analytics-value'>4.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>eastus</span>
                <span class='analytics-value'>4.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>westindia</span>
                <span class='analytics-value'>4.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>westcentralus</span>
                <span class='analytics-value'>4.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>northcentralus</span>
                <span class='analytics-value'>4.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>centralus</span>
                <span class='analytics-value'>4.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>ukwest</span>
                <span class='analytics-value'>4.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>westus2</span>
                <span class='analytics-value'>4.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>uksouth</span>
                <span class='analytics-value'>4.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>westeurope</span>
                <span class='analytics-value'>2.0%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>francecentral</span>
                <span class='analytics-value'>2.0%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>germanywestcentral</span>
                <span class='analytics-value'>2.0%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>norwayeast</span>
                <span class='analytics-value'>2.0%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>northeurope</span>
                <span class='analytics-value'>2.0%</span>
            </div></div>
            </div>
            <div class="analytics-card">
                <div class="analytics-title">Client Types Distribution</div>
                <div id='clientTypesSummary' class='analytics-list'><div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.windows.msrdc.x64 (1.2.5713.0)</span>
                <span class='analytics-value'>3.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.windows.msrdc.x64 (1.2.5806.0)</span>
                <span class='analytics-value'>3.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.windows.msrdc.x64 (1.2.5623.0)</span>
                <span class='analytics-value'>3.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.macos (2179)</span>
                <span class='analytics-value'>3.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.macos (2401)</span>
                <span class='analytics-value'>3.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>cpc.web.beta (2.0.02845.913)</span>
                <span class='analytics-value'>3.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.macos (2188)</span>
                <span class='analytics-value'>3.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.macos (2111)</span>
                <span class='analytics-value'>3.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.html (2.0.57.1)</span>
                <span class='analytics-value'>3.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.windows.msrdc.x64 (1.2.5559.0)</span>
                <span class='analytics-value'>3.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.macos (2257)</span>
                <span class='analytics-value'>3.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.html (2.0.46.2)</span>
                <span class='analytics-value'>3.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.windows.msrdc.x64 (1.2.5560.0)</span>
                <span class='analytics-value'>3.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.windows.msrdc.x64 (1.2.5709.0)</span>
                <span class='analytics-value'>3.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.macos (2327)</span>
                <span class='analytics-value'>3.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.windows.wa.msrdc.msix.x64 (1.2.5709.0)</span>
                <span class='analytics-value'>3.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.macos (2198)</span>
                <span class='analytics-value'>3.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.windows.store (3012)</span>
                <span class='analytics-value'>3.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.windows.wa.msrdc.msix.x64 (1.2.5716.0)</span>
                <span class='analytics-value'>1.8%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>cpc.web.beta (2.0.02881.925)</span>
                <span class='analytics-value'>1.8%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.windows.msrdc.x64 (1.2.5716.0)</span>
                <span class='analytics-value'>1.8%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.macos (2452)</span>
                <span class='analytics-value'>1.8%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.windows.msrdc.arm64 (1.2.5713.0)</span>
                <span class='analytics-value'>1.8%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.windows.msrdc.x64 (1.2.5704.0)</span>
                <span class='analytics-value'>1.8%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.windows.wa.msrdc.msix.arm64 (1.2.5804.0)</span>
                <span class='analytics-value'>1.8%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.windows.msrdc.x64 (1.2.5617.0)</span>
                <span class='analytics-value'>1.8%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.macos (2372)</span>
                <span class='analytics-value'>1.8%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.macos (2417)</span>
                <span class='analytics-value'>1.8%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.windows.msrdc.x64 (1.2.3004.0)</span>
                <span class='analytics-value'>1.8%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.windows.wa.msrdc.msix.arm64 (1.2.5799.0)</span>
                <span class='analytics-value'>1.8%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.macos (2161)</span>
                <span class='analytics-value'>1.8%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.macos (2382)</span>
                <span class='analytics-value'>1.8%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.windows.msrdc.x64 (1.2.5804.0)</span>
                <span class='analytics-value'>1.8%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.windows.msrdc.x64 (1.2.5802.0)</span>
                <span class='analytics-value'>1.8%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.windows.msrdc.x64 (1.2.5900.0)</span>
                <span class='analytics-value'>1.8%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.windows.wa.msrdc.msix.arm64 (1.2.5802.0)</span>
                <span class='analytics-value'>1.8%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.windows.wa.msrdc.msix.arm64 (1.2.5709.0)</span>
                <span class='analytics-value'>1.8%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>com.microsoft.rdc.windows.wa.msrdc.msix.arm64 (1.2.5716.0)</span>
                <span class='analytics-value'>1.8%</span>
            </div></div>
            </div>
            <div class="analytics-card">
                <div class="analytics-title">Client OS Distribution</div>
                <div id='clientOSSummary' class='analytics-list'><div class='analytics-list-item'>
                <span class='analytics-label'>WINDOWS 10.0.22631.4460</span>
                <span class='analytics-value'>3.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>WINDOWS 10.0.26100.2161</span>
                <span class='analytics-value'>3.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>macOS 13.4.0</span>
                <span class='analytics-value'>3.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>Windows 10 10.0.22631.4460</span>
                <span class='analytics-value'>3.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>WINDOWS 10.0.26100.2454</span>
                <span class='analytics-value'>3.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>WINDOWS 10.0.22631.4541</span>
                <span class='analytics-value'>3.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>WINDOWS 10.0.22000.2538</span>
                <span class='analytics-value'>3.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>macOS 13.5.0</span>
                <span class='analytics-value'>3.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'><></span>
                <span class='analytics-value'>3.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>WINDOWS 10.0.22621.4317</span>
                <span class='analytics-value'>3.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>WINDOWS 10.0.22631.4317</span>
                <span class='analytics-value'>3.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>WINDOWS 10.0.19045.5011</span>
                <span class='analytics-value'>3.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>macOS 14.6.0</span>
                <span class='analytics-value'>3.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>Windows 10</span>
                <span class='analytics-value'>3.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>WINDOWS 10.0.26100.2314</span>
                <span class='analytics-value'>3.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>Windows 10 10.0.26100.2314</span>
                <span class='analytics-value'>3.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>macOS 14.6.1</span>
                <span class='analytics-value'>3.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>WINDOWS 10.0.19045.5131</span>
                <span class='analytics-value'>3.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>macOS 15.1.1</span>
                <span class='analytics-value'>3.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>Linux x86_64</span>
                <span class='analytics-value'>3.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>macOS 13.6.3</span>
                <span class='analytics-value'>3.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>macOS 10.15.7</span>
                <span class='analytics-value'>3.1%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>Windows 10 10.0.26100.2033</span>
                <span class='analytics-value'>1.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>WINDOWS 10.0.22635.4515</span>
                <span class='analytics-value'>1.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>WINDOWS 10.0.22000.3019</span>
                <span class='analytics-value'>1.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>WINDOWS 10.0.19045.5247</span>
                <span class='analytics-value'>1.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>WINDOWS 10.0.26100.2605</span>
                <span class='analytics-value'>1.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>WINDOWS 10.0.22631.4602</span>
                <span class='analytics-value'>1.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>macOS 15.2.0</span>
                <span class='analytics-value'>1.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>Windows 10 10.0.22621.4460</span>
                <span class='analytics-value'>1.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>Windows 10 10.0.26100.2454</span>
                <span class='analytics-value'>1.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>WINDOWS 10.0.22621.2861</span>
                <span class='analytics-value'>1.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>WINDOWS 10.0.26100.2448</span>
                <span class='analytics-value'>1.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>WINDOWS 10.0.22631.4391</span>
                <span class='analytics-value'>1.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>macOS 15.1.0</span>
                <span class='analytics-value'>1.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>Windows 10 10.0.22631.4317</span>
                <span class='analytics-value'>1.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>WINDOWS 10.0.26100.2033</span>
                <span class='analytics-value'>1.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>macOS 15.0.1</span>
                <span class='analytics-value'>1.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>macOS 14.5.0</span>
                <span class='analytics-value'>1.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>macOS 14.7.1</span>
                <span class='analytics-value'>1.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>WINDOWS 10.0.26100.2152</span>
                <span class='analytics-value'>1.6%</span>
            </div>
<div class='analytics-list-item'>
                <span class='analytics-label'>WINDOWS 10.0.22635.4580</span>
                <span class='analytics-value'>1.6%</span>
            </div></div>
            </div>
        </div>

        <div class="chart-container">
            <div class="chart-wrapper">
                <div class="chart-info">Transport Types Distribution (Last 2 Months)</div>
                <canvas id="transportTypesChart"></canvas>
            </div>
            <div class="chart-wrapper">
                <div class="chart-info">Gateway Regions Distribution (Last 2 Months)</div>
                <canvas id="gatewayRegionsChart"></canvas>
            </div>
            <div class="chart-wrapper">
                <div class="chart-info">Client Types Distribution (Last 2 Months)</div>
                <canvas id="clientTypesChart"></canvas>
            </div>
            <div class="chart-wrapper">
                <div class="chart-info">Client OS Distribution (Last 2 Months)</div>
                <canvas id="clientOSChart"></canvas>
            </div>
        </div>
    </div>

    <div class="section">
        <div class="section-title">Monthly Statistics</div>
                <table>
            <thead>
                <tr>
                    <th>Month</th>
                    <th>Users</th>
                    <th>Active Sessions</th>
                    <th>Completed Sessions</th>
                    <th>Total Sessions</th>
                    <th>Unique Clients</th>
                    <th>Unique Hosts</th>
                    <th>Avg Session Duration</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                        <td>2024-11</td>
                        <td>80</td>
                        <td>1464</td>
                        <td>1702</td>
                        <td>4844</td>
                        <td>179</td>
                        <td>11</td>
                        <td class='session-duration'>02:17:42.2510217</td>
                    </tr>
<tr>
                        <td>2024-12</td>
                        <td>70</td>
                        <td>1086</td>
                        <td>1220</td>
                        <td>3541</td>
                        <td>136</td>
                        <td>8</td>
                        <td class='session-duration'>02:39:24.0486032</td>
                    </tr>
            </tbody>
        </table>
    </div>

    <div class="section">
        <div class="section-title">Weekly Statistics</div>
                <table>
            <thead>
                <tr>
                    <th>Week</th>
                    <th>Users</th>
                    <th>Active Sessions</th>
                    <th>Completed Sessions</th>
                    <th>Total Sessions</th>
                    <th>Unique Hosts</th>
                    <th>Avg Session Duration</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                        <td>2024-W46</td>
                        <td>59</td>
                        <td>389</td>
                        <td>455</td>
                        <td>1275</td>
                        <td>7</td>
                        <td class='session-duration'>01:55:33.6770821</td>
                    </tr>
<tr>
                        <td>2024-W47</td>
                        <td>70</td>
                        <td>613</td>
                        <td>717</td>
                        <td>2047</td>
                        <td>11</td>
                        <td class='session-duration'>02:32:29.4252446</td>
                    </tr>
<tr>
                        <td>2024-W48</td>
                        <td>62</td>
                        <td>467</td>
                        <td>536</td>
                        <td>1539</td>
                        <td>7</td>
                        <td class='session-duration'>02:16:13.0026934</td>
                    </tr>
<tr>
                        <td>2024-W49</td>
                        <td>62</td>
                        <td>602</td>
                        <td>689</td>
                        <td>1983</td>
                        <td>8</td>
                        <td class='session-duration'>02:44:08.7042734</td>
                    </tr>
<tr>
                        <td>2024-W50</td>
                        <td>59</td>
                        <td>479</td>
                        <td>525</td>
                        <td>1541</td>
                        <td>8</td>
                        <td class='session-duration'>02:34:03.5693642</td>
                    </tr>
            </tbody>
        </table>
    </div>

    <div class="section">
        <div class="section-title">Daily Statistics (Last 7 Days)</div>
                <table>
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Users</th>
                    <th>Active Sessions</th>
                    <th>Completed Sessions</th>
                    <th>Total Sessions</th>
                    <th>Unique Clients</th>
                    <th>Avg Session Duration</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                        <td>2024-12-12</td>
                        <td>45</td>
                        <td>111</td>
                        <td>126</td>
                        <td>366</td>
                        <td>49</td>
                        <td class='session-duration'>02:00:13.0320140</td>
                    </tr>
<tr>
                        <td>2024-12-11</td>
                        <td>46</td>
                        <td>117</td>
                        <td>137</td>
                        <td>388</td>
                        <td>52</td>
                        <td class='session-duration'>02:39:43.1099528</td>
                    </tr>
<tr>
                        <td>2024-12-10</td>
                        <td>45</td>
                        <td>112</td>
                        <td>119</td>
                        <td>351</td>
                        <td>51</td>
                        <td class='session-duration'>03:09:13.3407961</td>
                    </tr>
<tr>
                        <td>2024-12-09</td>
                        <td>44</td>
                        <td>139</td>
                        <td>143</td>
                        <td>436</td>
                        <td>52</td>
                        <td class='session-duration'>02:24:49.4111705</td>
                    </tr>
<tr>
                        <td>2024-12-08</td>
                        <td>4</td>
                        <td>6</td>
                        <td>7</td>
                        <td>20</td>
                        <td>4</td>
                        <td class='session-duration'>01:05:10.8468729</td>
                    </tr>
<tr>
                        <td>2024-12-07</td>
                        <td>8</td>
                        <td>6</td>
                        <td>12</td>
                        <td>26</td>
                        <td>8</td>
                        <td class='session-duration'>01:04:07.3084231</td>
                    </tr>
<tr>
                        <td>2024-12-06</td>
                        <td>46</td>
                        <td>129</td>
                        <td>146</td>
                        <td>417</td>
                        <td>52</td>
                        <td class='session-duration'>02:13:27.1489686</td>
                    </tr>
            </tbody>
        </table>
    </div>

    <script>
        const chartOptions = {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
        legend: {
            position: 'right',
            labels: {
                boxWidth: 12,
                padding: 10,
                font: {
                    size: 11
                }
            }
        },
        tooltip: {
            callbacks: {
                label: function(context) {
                    let label = context.label || '';
                    let value = context.raw || 0;
                    return `${label}: ${value.toFixed(1)}%`;
                }
            }
        }
    }
};

const chartColors = [
    '#1B9CB9', '#D7DF23', '#13BA7C', '#1D3557', '#FF6B6B',
    '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEEAD', '#FF9F1C'
];

let charts = {
    transportTypes: null,
    gatewayRegions: null,
    clientTypes: null,
    clientOS: null
};

        // Template for chart data structure
const chartDataTemplate = {
    transportTypes: {
        labels: [],
        data: []
    },
    gatewayRegions: {
        labels: [],
        data: []
    },
    clientTypes: {
        labels: [],
        data: []
    },
    clientOSs: {
        labels: [],
        data: []
    }
};

// Data containers for different time ranges
let monthlyData = JSON.parse(JSON.stringify(chartDataTemplate));
let weeklyData = JSON.parse(JSON.stringify(chartDataTemplate));
let dailyData = JSON.parse(JSON.stringify(chartDataTemplate));

// Function to update data for a specific time range
function updateChartData(timeRange, newData) {
    switch(timeRange) {
        case 'monthly':
            monthlyData = newData;
            break;
        case 'weekly':
            weeklyData = newData;
            break;
        case 'daily':
            dailyData = newData;
            break;
        default:
            console.error(`Invalid time range: ${timeRange}`);
    }
}

        // Initialize chart data
        monthlyData = {
            transportTypes: {
                labels: [
  "TURN",
  "Websocket",
  "Shortpath"
],
                data: [
  33.3,
  33.3,
  33.3
]
            },
            gatewayRegions: {
                labels: [
  "eastus2",
  "<>",
  "southeastasia",
  "southindia",
  "centralindia",
  "australiasoutheast",
  "australiaeast",
  "southafricanorth",
  "switzerlandnorth",
  "israelcentral",
  "westus",
  "westus3",
  "brazilsouth",
  "southcentralus",
  "eastus",
  "westindia",
  "westcentralus",
  "northcentralus",
  "centralus",
  "ukwest",
  "westus2",
  "uksouth",
  "westeurope",
  "francecentral",
  "germanywestcentral",
  "norwayeast",
  "northeurope"
],
                data: [
  4.1,
  4.1,
  4.1,
  4.1,
  4.1,
  4.1,
  4.1,
  4.1,
  4.1,
  4.1,
  4.1,
  4.1,
  4.1,
  4.1,
  4.1,
  4.1,
  4.1,
  4.1,
  4.1,
  4.1,
  4.1,
  4.1,
  2.0,
  2.0,
  2.0,
  2.0,
  2.0
]
            },
            clientTypes: {
                labels: [
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5713.0)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5806.0)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5623.0)",
  "com.microsoft.rdc.macos (2179)",
  "com.microsoft.rdc.macos (2401)",
  "cpc.web.beta (2.0.02845.913)",
  "com.microsoft.rdc.macos (2188)",
  "com.microsoft.rdc.macos (2111)",
  "com.microsoft.rdc.html (2.0.57.1)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5559.0)",
  "com.microsoft.rdc.macos (2257)",
  "com.microsoft.rdc.html (2.0.46.2)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5560.0)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5709.0)",
  "com.microsoft.rdc.macos (2327)",
  "com.microsoft.rdc.windows.wa.msrdc.msix.x64 (1.2.5709.0)",
  "com.microsoft.rdc.macos (2198)",
  "com.microsoft.rdc.windows.store (3012)",
  "com.microsoft.rdc.windows.wa.msrdc.msix.x64 (1.2.5716.0)",
  "cpc.web.beta (2.0.02881.925)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5716.0)",
  "com.microsoft.rdc.macos (2452)",
  "com.microsoft.rdc.windows.msrdc.arm64 (1.2.5713.0)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5704.0)",
  "com.microsoft.rdc.windows.wa.msrdc.msix.arm64 (1.2.5804.0)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5617.0)",
  "com.microsoft.rdc.macos (2372)",
  "com.microsoft.rdc.macos (2417)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.3004.0)",
  "com.microsoft.rdc.windows.wa.msrdc.msix.arm64 (1.2.5799.0)",
  "com.microsoft.rdc.macos (2161)",
  "com.microsoft.rdc.macos (2382)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5804.0)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5802.0)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5900.0)",
  "com.microsoft.rdc.windows.wa.msrdc.msix.arm64 (1.2.5802.0)",
  "com.microsoft.rdc.windows.wa.msrdc.msix.arm64 (1.2.5709.0)",
  "com.microsoft.rdc.windows.wa.msrdc.msix.arm64 (1.2.5716.0)"
],
                data: [
  3.6,
  3.6,
  3.6,
  3.6,
  3.6,
  3.6,
  3.6,
  3.6,
  3.6,
  3.6,
  3.6,
  3.6,
  3.6,
  3.6,
  3.6,
  3.6,
  3.6,
  3.6,
  1.8,
  1.8,
  1.8,
  1.8,
  1.8,
  1.8,
  1.8,
  1.8,
  1.8,
  1.8,
  1.8,
  1.8,
  1.8,
  1.8,
  1.8,
  1.8,
  1.8,
  1.8,
  1.8,
  1.8
]
            },
            clientOSs: {
                labels: [
  "WINDOWS 10.0.22631.4460",
  "WINDOWS 10.0.26100.2161",
  "macOS 13.4.0",
  "Windows 10 10.0.22631.4460",
  "WINDOWS 10.0.26100.2454",
  "WINDOWS 10.0.22631.4541",
  "WINDOWS 10.0.22000.2538",
  "macOS 13.5.0",
  "<>",
  "WINDOWS 10.0.22621.4317",
  "WINDOWS 10.0.22631.4317",
  "WINDOWS 10.0.19045.5011",
  "macOS 14.6.0",
  "Windows 10",
  "WINDOWS 10.0.26100.2314",
  "Windows 10 10.0.26100.2314",
  "macOS 14.6.1",
  "WINDOWS 10.0.19045.5131",
  "macOS 15.1.1",
  "Linux x86_64",
  "macOS 13.6.3",
  "macOS 10.15.7",
  "Windows 10 10.0.26100.2033",
  "WINDOWS 10.0.22635.4515",
  "WINDOWS 10.0.22000.3019",
  "WINDOWS 10.0.19045.5247",
  "WINDOWS 10.0.26100.2605",
  "WINDOWS 10.0.22631.4602",
  "macOS 15.2.0",
  "Windows 10 10.0.22621.4460",
  "Windows 10 10.0.26100.2454",
  "WINDOWS 10.0.22621.2861",
  "WINDOWS 10.0.26100.2448",
  "WINDOWS 10.0.22631.4391",
  "macOS 15.1.0",
  "Windows 10 10.0.22631.4317",
  "WINDOWS 10.0.26100.2033",
  "macOS 15.0.1",
  "macOS 14.5.0",
  "macOS 14.7.1",
  "WINDOWS 10.0.26100.2152",
  "WINDOWS 10.0.22635.4580"
],
                data: [
  3.1,
  3.1,
  3.1,
  3.1,
  3.1,
  3.1,
  3.1,
  3.1,
  3.1,
  3.1,
  3.1,
  3.1,
  3.1,
  3.1,
  3.1,
  3.1,
  3.1,
  3.1,
  3.1,
  3.1,
  3.1,
  3.1,
  1.6,
  1.6,
  1.6,
  1.6,
  1.6,
  1.6,
  1.6,
  1.6,
  1.6,
  1.6,
  1.6,
  1.6,
  1.6,
  1.6,
  1.6,
  1.6,
  1.6,
  1.6,
  1.6,
  1.6
]
            }
        };

        weeklyData = {
            transportTypes: {
                labels: [
  "Websocket",
  "TURN",
  "Shortpath"
],
                data: [
  33.3,
  33.3,
  33.3
]
            },
            gatewayRegions: {
                labels: [
  "centralus",
  "israelcentral",
  "<>",
  "southcentralus",
  "westus3",
  "southafricanorth",
  "switzerlandnorth",
  "ukwest",
  "centralindia",
  "westcentralus",
  "westindia",
  "westus2",
  "northcentralus",
  "eastus",
  "eastus2",
  "uksouth",
  "westus",
  "australiasoutheast",
  "australiaeast",
  "southeastasia",
  "brazilsouth",
  "southindia",
  "francecentral",
  "norwayeast",
  "germanywestcentral",
  "northeurope",
  "westeurope"
],
                data: [
  4.6,
  4.6,
  4.6,
  4.6,
  4.6,
  4.6,
  4.6,
  4.6,
  4.6,
  4.6,
  4.6,
  4.6,
  4.6,
  4.6,
  4.6,
  4.6,
  4.6,
  3.7,
  3.7,
  2.8,
  2.8,
  2.8,
  1.8,
  1.8,
  0.9,
  0.9,
  0.9
]
            },
            clientTypes: {
                labels: [
  "com.microsoft.rdc.windows.store (3012)",
  "com.microsoft.rdc.macos (2198)",
  "com.microsoft.rdc.macos (2257)",
  "com.microsoft.rdc.html (2.0.57.1)",
  "com.microsoft.rdc.macos (2111)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5559.0)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5623.0)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5560.0)",
  "com.microsoft.rdc.macos (2188)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5709.0)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5713.0)",
  "com.microsoft.rdc.html (2.0.46.2)",
  "com.microsoft.rdc.macos (2327)",
  "com.microsoft.rdc.windows.wa.msrdc.msix.x64 (1.2.5709.0)",
  "com.microsoft.rdc.macos (2179)",
  "cpc.web.beta (2.0.02845.913)",
  "com.microsoft.rdc.macos (2401)",
  "com.microsoft.rdc.windows.wa.msrdc.msix.arm64 (1.2.5802.0)",
  "com.microsoft.rdc.windows.wa.msrdc.msix.arm64 (1.2.5709.0)",
  "com.microsoft.rdc.macos (2161)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5806.0)",
  "com.microsoft.rdc.macos (2417)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5802.0)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5804.0)",
  "com.microsoft.rdc.macos (2382)",
  "com.microsoft.rdc.macos (2452)",
  "com.microsoft.rdc.windows.wa.msrdc.msix.arm64 (1.2.5799.0)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.3004.0)",
  "com.microsoft.rdc.windows.msrdc.arm64 (1.2.5713.0)",
  "com.microsoft.rdc.windows.wa.msrdc.msix.arm64 (1.2.5804.0)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5704.0)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5617.0)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5716.0)",
  "com.microsoft.rdc.windows.wa.msrdc.msix.x64 (1.2.5716.0)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5900.0)",
  "com.microsoft.rdc.windows.wa.msrdc.msix.arm64 (1.2.5716.0)",
  "com.microsoft.rdc.macos (2372)",
  "cpc.web.beta (2.0.02881.925)"
],
                data: [
  4.3,
  4.3,
  4.3,
  4.3,
  4.3,
  4.3,
  4.3,
  4.3,
  4.3,
  4.3,
  4.3,
  4.3,
  4.3,
  4.3,
  3.4,
  3.4,
  3.4,
  2.6,
  2.6,
  2.6,
  2.6,
  2.6,
  1.7,
  1.7,
  1.7,
  0.9,
  0.9,
  0.9,
  0.9,
  0.9,
  0.9,
  0.9,
  0.9,
  0.9,
  0.9,
  0.9,
  0.9,
  0.9
]
            },
            clientOSs: {
                labels: [
  "Windows 10 10.0.26100.2314",
  "WINDOWS 10.0.19045.5131",
  "macOS 14.6.0",
  "<>",
  "Linux x86_64",
  "macOS 10.15.7",
  "WINDOWS 10.0.19045.5011",
  "WINDOWS 10.0.22621.4317",
  "WINDOWS 10.0.26100.2314",
  "macOS 13.6.3",
  "macOS 14.6.1",
  "WINDOWS 10.0.22631.4460",
  "Windows 10",
  "WINDOWS 10.0.22000.2538",
  "macOS 13.5.0",
  "WINDOWS 10.0.22631.4317",
  "WINDOWS 10.0.26100.2454",
  "macOS 15.1.1",
  "WINDOWS 10.0.22631.4541",
  "Windows 10 10.0.22631.4460",
  "macOS 14.5.0",
  "WINDOWS 10.0.26100.2161",
  "WINDOWS 10.0.22631.4391",
  "macOS 15.1.0",
  "WINDOWS 10.0.26100.2033",
  "macOS 15.0.1",
  "WINDOWS 10.0.26100.2448",
  "macOS 13.4.0",
  "Windows 10 10.0.26100.2033",
  "Windows 10 10.0.22621.4460",
  "macOS 15.2.0",
  "WINDOWS 10.0.26100.2605",
  "WINDOWS 10.0.22000.3019",
  "WINDOWS 10.0.22635.4580",
  "WINDOWS 10.0.22631.4602",
  "Windows 10 10.0.22631.4317",
  "Windows 10 10.0.26100.2454",
  "WINDOWS 10.0.19045.5247",
  "WINDOWS 10.0.22621.2861",
  "WINDOWS 10.0.26100.2152",
  "WINDOWS 10.0.22635.4515",
  "macOS 14.7.1"
],
                data: [
  3.9,
  3.9,
  3.9,
  3.9,
  3.9,
  3.9,
  3.9,
  3.9,
  3.9,
  3.9,
  3.9,
  3.9,
  3.9,
  3.9,
  3.1,
  3.1,
  3.1,
  3.1,
  2.3,
  2.3,
  2.3,
  2.3,
  2.3,
  2.3,
  2.3,
  1.6,
  1.6,
  1.6,
  1.6,
  1.6,
  0.8,
  0.8,
  0.8,
  0.8,
  0.8,
  0.8,
  0.8,
  0.8,
  0.8,
  0.8,
  0.8,
  0.8
]
            }
        };

        dailyData = {
            transportTypes: {
                labels: [
  "Websocket",
  "TURN",
  "Shortpath"
],
                data: [
  35.7,
  35.7,
  28.6
]
            },
            gatewayRegions: {
                labels: [
  "eastus2",
  "eastus",
  "centralus",
  "uksouth",
  "southafricanorth",
  "northcentralus",
  "westus3",
  "westus",
  "switzerlandnorth",
  "westcentralus",
  "westus2",
  "centralindia",
  "westindia",
  "southcentralus",
  "ukwest",
  "israelcentral",
  "<>",
  "australiaeast",
  "southeastasia",
  "brazilsouth",
  "australiasoutheast",
  "norwayeast",
  "francecentral",
  "southindia",
  "westeurope",
  "northeurope",
  "germanywestcentral"
],
                data: [
  6.9,
  6.4,
  6.4,
  6.2,
  5.9,
  5.9,
  5.5,
  5.2,
  5.2,
  5.2,
  5.2,
  5.0,
  5.0,
  4.7,
  4.5,
  4.0,
  2.4,
  2.1,
  1.9,
  1.9,
  1.2,
  0.9,
  0.7,
  0.7,
  0.5,
  0.2,
  0.2
]
            },
            clientTypes: {
                labels: [
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5713.0)",
  "com.microsoft.rdc.macos (2327)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5709.0)",
  "com.microsoft.rdc.html (2.0.46.2)",
  "com.microsoft.rdc.macos (2111)",
  "com.microsoft.rdc.windows.store (3012)",
  "com.microsoft.rdc.windows.wa.msrdc.msix.x64 (1.2.5709.0)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5559.0)",
  "com.microsoft.rdc.macos (2257)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5623.0)",
  "com.microsoft.rdc.macos (2198)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5560.0)",
  "com.microsoft.rdc.macos (2188)",
  "com.microsoft.rdc.html (2.0.57.1)",
  "cpc.web.beta (2.0.02845.913)",
  "com.microsoft.rdc.windows.wa.msrdc.msix.arm64 (1.2.5709.0)",
  "com.microsoft.rdc.macos (2401)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5806.0)",
  "com.microsoft.rdc.windows.wa.msrdc.msix.arm64 (1.2.5802.0)",
  "com.microsoft.rdc.windows.wa.msrdc.msix.arm64 (1.2.5804.0)",
  "com.microsoft.rdc.macos (2161)",
  "com.microsoft.rdc.macos (2179)",
  "com.microsoft.rdc.macos (2417)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5802.0)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5804.0)",
  "com.microsoft.rdc.macos (2382)",
  "com.microsoft.rdc.windows.wa.msrdc.msix.arm64 (1.2.5799.0)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5716.0)",
  "com.microsoft.rdc.macos (2452)",
  "cpc.web.beta (2.0.02881.925)",
  "com.microsoft.rdc.windows.wa.msrdc.msix.x64 (1.2.5716.0)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.3004.0)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5617.0)",
  "com.microsoft.rdc.windows.msrdc.arm64 (1.2.5713.0)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5704.0)",
  "com.microsoft.rdc.windows.msrdc.x64 (1.2.5900.0)",
  "com.microsoft.rdc.macos (2372)",
  "com.microsoft.rdc.windows.wa.msrdc.msix.arm64 (1.2.5716.0)"
],
                data: [
  7.5,
  7.2,
  6.5,
  6.2,
  6.2,
  6.0,
  6.0,
  5.5,
  5.2,
  5.2,
  5.0,
  5.0,
  4.8,
  4.0,
  2.5,
  2.5,
  2.2,
  1.5,
  1.2,
  1.0,
  1.0,
  1.0,
  0.8,
  0.8,
  0.5,
  0.5,
  0.5,
  0.5,
  0.5,
  0.5,
  0.2,
  0.2,
  0.2,
  0.2,
  0.2,
  0.2,
  0.2,
  0.2
]
            },
            clientOSs: {
                labels: [
  "WINDOWS 10.0.22631.4460",
  "macOS 14.6.1",
  "Windows 10 10.0.26100.2314",
  "WINDOWS 10.0.22621.4317",
  "WINDOWS 10.0.26100.2314",
  "macOS 10.15.7",
  "WINDOWS 10.0.19045.5131",
  "WINDOWS 10.0.22000.2538",
  "macOS 13.6.3",
  "WINDOWS 10.0.26100.2454",
  "Windows 10",
  "macOS 15.1.1",
  "WINDOWS 10.0.22631.4317",
  "WINDOWS 10.0.19045.5011",
  "Linux x86_64",
  "<>",
  "WINDOWS 10.0.22631.4391",
  "WINDOWS 10.0.22631.4541",
  "macOS 14.6.0",
  "Windows 10 10.0.22631.4460",
  "macOS 15.1.0",
  "Windows 10 10.0.26100.2033",
  "macOS 15.0.1",
  "macOS 13.5.0",
  "WINDOWS 10.0.26100.2033",
  "macOS 14.5.0",
  "macOS 15.2.0",
  "WINDOWS 10.0.26100.2448",
  "Windows 10 10.0.22631.4317",
  "WINDOWS 10.0.26100.2161",
  "WINDOWS 10.0.26100.2605",
  "WINDOWS 10.0.22631.4602",
  "Windows 10 10.0.22621.4460",
  "WINDOWS 10.0.22000.3019",
  "macOS 13.4.0",
  "WINDOWS 10.0.26100.2152",
  "Windows 10 10.0.26100.2454",
  "WINDOWS 10.0.22621.2861",
  "WINDOWS 10.0.19045.5247",
  "WINDOWS 10.0.22635.4515",
  "macOS 14.7.1",
  "WINDOWS 10.0.22635.4580"
],
                data: [
  6.7,
  6.7,
  5.4,
  5.1,
  4.9,
  4.9,
  4.7,
  4.5,
  4.5,
  4.2,
  4.0,
  4.0,
  3.8,
  3.3,
  3.1,
  3.1,
  2.7,
  2.7,
  2.2,
  1.8,
  1.8,
  1.8,
  1.8,
  1.6,
  1.6,
  1.3,
  0.9,
  0.7,
  0.7,
  0.7,
  0.4,
  0.4,
  0.4,
  0.4,
  0.4,
  0.4,
  0.4,
  0.4,
  0.4,
  0.4,
  0.2,
  0.2
]
            }
        };
        function createChart(id, data, labels) {
    const ctx = document.getElementById(id);
    if (!ctx) {
        console.error(`Canvas element not found: ${id}`);
        return null;
    }

    return new Chart(ctx, {
        type: 'pie',
        data: {
            labels: labels,
            datasets: [{
                data: data,
                backgroundColor: chartColors
            }]
        },
        options: chartOptions
    });
}

function updateSummaries(timeRange) {
    const data = timeRange === 'weekly' ? weeklyData :
                timeRange === 'daily' ? dailyData : monthlyData;

    // Update analytics summaries
    ['transportTypes', 'gatewayRegions', 'clientTypes', 'clientOSs'].forEach(type => {
        const summaryHtml = data[type].labels.map((label, index) => {
            const value = data[type].data[index];
            return `<div class="analytics-list-item">
                <span class="analytics-label">${label}</span>
                <span class="analytics-value">${value.toFixed(1)}%</span>
            </div>`;
        }).join('\n');
        const element = document.getElementById(`${type}Summary`);
        if (element) {
            element.innerHTML = summaryHtml;
        }
    });
}

function updateCharts(timeRange) {
    const data = timeRange === 'weekly' ? weeklyData :
                timeRange === 'daily' ? dailyData : monthlyData;

    // Update time range description
    const timeDesc = timeRange === 'weekly' ? 'Last 4 Weeks' :
                   timeRange === 'daily' ? 'Last 7 Days' : 'Last 2 Months';
    document.querySelectorAll('.chart-info').forEach(el => {
        const baseText = el.textContent.split('(')[0].trim();
        el.textContent = `${baseText} (${timeDesc})`;
    });

    // Update summaries
    updateSummaries(timeRange);

    // Destroy existing charts
    Object.entries(charts).forEach(([key, chart]) => {
        if (chart) {
            chart.destroy();
            charts[key] = null;
        }
    });

    // Create new charts
    charts.transportTypes = createChart('transportTypesChart', 
        data.transportTypes.data, data.transportTypes.labels);
    charts.gatewayRegions = createChart('gatewayRegionsChart',
        data.gatewayRegions.data, data.gatewayRegions.labels);
    charts.clientTypes = createChart('clientTypesChart',
        data.clientTypes.data, data.clientTypes.labels);
    charts.clientOS = createChart('clientOSChart',
        data.clientOSs.data, data.clientOSs.labels);
}

// Initialize charts with monthly data when DOM is loaded
document.addEventListener('DOMContentLoaded', function() {
    updateCharts('monthly');

    // Add event listener to time range selector
    const selector = document.getElementById('timeRange');
    if (selector) {
        selector.addEventListener('change', function(e) {
            updateCharts(e.target.value);
        });
    }
});

    </script>
</body>
</html>

